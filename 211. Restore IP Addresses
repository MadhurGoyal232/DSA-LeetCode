class Solution {

    public boolean isValid(String str){
        if(str.charAt(0) == '0'){
            return false;
        }

        int val = Integer.valueOf(str);
        return val<=255;
    }

    public void helper(String s, int idx, int parts, StringBuilder sb, List<String> ans){
        int n = s.length();
        if (parts == 4) {
            // Valid only if all characters are used
            if (idx == s.length()) {
                ans.add(sb.substring(0, sb.length() - 1)); // remove last dot
            }
            return;
        }
        int lenBefore = sb.length();
        if(idx+1<=n){
            helper(s, idx+1, parts+1, sb.append(s.substring(idx, idx+1) + ".") , ans);
            sb.setLength(lenBefore);
        }

        if(idx+2<=n && isValid(s.substring(idx, idx+2))){
            helper(s, idx+2, parts+1, sb.append(s.substring(idx, idx+2) + ".") , ans);
            sb.setLength(lenBefore);
        }

        if(idx+3<=n && isValid(s.substring(idx, idx+3))){
            helper(s, idx+3, parts+1, sb.append(s.substring(idx, idx+3) + ".") , ans);
            sb.setLength(lenBefore);
        }
    }
    public List<String> restoreIpAddresses(String s) {
        List<String> ans = new ArrayList<>();
        int parts = 0;
        StringBuilder sb = new StringBuilder();
        if(s.length() > 12){
            return ans;
        }
        helper(s, 0, parts, sb, ans);
        return ans;
    }
}
